model ProviderSchedule {
    id                       String                         @id @default(uuid())
    providerProfileId        String                         @unique @map("provider_profile_id")
    providerProfile          ProviderProfile                @relation(fields: [providerProfileId], references: [id], onDelete: Cascade)
    availabilities           ProviderScheduleAvailability[]
    appointments             Appointment[]
    providerScheduleOverride ProviderScheduleOverride[]

    createdAt DateTime @default(now()) @map("created_at")
    updatedAt DateTime @updatedAt @map("updated_at")

    @@map("provider_schedules")
}

model ProviderScheduleAvailability {
    id                 String            @id @default(uuid())
    providerScheduleId String            @map("provider_schedule_id")
    providerSchedule   ProviderSchedule  @relation(fields: [providerScheduleId], references: [id], onDelete: Cascade)
    startTime          String            @map("start_time")
    endTime            String            @map("end_time")
    dayOfWeek          ScheduleDayOfWeek @map("day_of_week")
    weekType           WeekType          @default(ALL) @map("week_type")

    @@index([providerScheduleId], name: "provider_schedule_id_index")
    @@map("provider_schedule_availabilities")
}

model ProviderScheduleOverride {
    id          String   @id @default(uuid())
    date        DateTime // The date of the override
    isAvailable Boolean  @default(false) @map("is_available")
    reason      String? // Optional reason for the override (e.g., "Holiday", "Vacation")
    startTime   String?  @map("start_time") // Optional specific time override
    endTime     String?  @map("end_time") // Optional specific time override

    providerScheduleId String           @map("provider_schedule_id")
    providerSchedule   ProviderSchedule @relation(fields: [providerScheduleId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now()) @map("created_at")
    updatedAt DateTime @updatedAt @map("updated_at")

    @@index([providerScheduleId, date]) // Index for efficient querying
    @@map("provider_schedule_overrides")
}

enum ScheduleDayOfWeek {
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
    SUNDAY

    @@map("schedule_day_of_week")
}

enum WeekType {
    ALL
    ODD
    EVEN

    @@map("week_type")
}
